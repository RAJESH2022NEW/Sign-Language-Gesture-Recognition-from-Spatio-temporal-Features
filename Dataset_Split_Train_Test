# -*- coding: utf-8 -*-
"""Dataset_split_train_test.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1LtCl70EcalAqeOCk0NGZM6XBhrW1Uddk
"""

from google.colab import drive
drive.mount('/content/drive')

import os
import numpy as np
import shutil
import random
import tensorflow as tf

"""-- **Confirm Sorce and destination dataset directories**"""

root_src_dir = '/content/drive/MyDrive/Colab Notebooks/Dataset/LSA_64'
root_dest_dir = '/content/drive/MyDrive/Colab Notebooks/SLGR/Dataset/LSA_64'

classes_dir=os.listdir(root_src_dir+'/')
print(classes_dir)

test_ratio = 0.20

for cls in classes_dir:
    if not os.path.exists(root_dest_dir +'/Train_set_videos/' + cls):
        os.makedirs(root_dest_dir +'/Train_set_videos/' + cls)
    if not os.path.exists(root_dest_dir +'/Test_set_videos/' + cls):
        os.makedirs(root_dest_dir +'/Test_set_videos/' + cls)
    dst_train_files = os.listdir(root_dest_dir +'/Train_set_videos/' + cls)
    dst_test_files = os.listdir(root_dest_dir +'/Test_set_videos/' + cls)
    if not len(dst_train_files)==0:
      shutil.rmtree(root_dest_dir +'/Train_set_videos/' + cls)
      os.makedirs(root_dest_dir +'/Train_set_videos/' + cls)
    if not len(dst_test_files)==0:
      shutil.rmtree(root_dest_dir +'/Test_set_videos/' + cls)
      os.makedirs(root_dest_dir +'/Test_set_videos/' + cls)  
    src = root_src_dir +'/'+ cls
    allFileNames = os.listdir(src)
    np.random.shuffle(allFileNames)
    train_FileNames, test_FileNames = np.split(np.array(allFileNames),
                                                          [int(len(allFileNames)* (1 - test_ratio))])
    train_FileNames = [src+'/'+ name for name in train_FileNames.tolist()]
    test_FileNames = [src+'/' + name for name in test_FileNames.tolist()]
    print("*****************************")
    print(cls)
    print("*****************************")
    print('Total images: ', len(allFileNames))
    print('Training: ', len(train_FileNames))
    print('Testing: ', len(test_FileNames))
    print("*****************************")
    for name in train_FileNames:
        shutil.copy(name, root_dest_dir +'/Train_set_videos/' + cls)
    for name in test_FileNames:
        shutil.copy(name, root_dest_dir +'/Test_set_videos/' + cls)
print("Copying Done!")

drive.flush_and_unmount()
